{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://github.com/serpro69/claude-starter-kit/template-state-schema.json",
  "title": "Template State Manifest",
  "description": "Schema for .github/template-state.json - tracks template version and substitution variables for sync operations",
  "type": "object",
  "required": ["schema_version", "upstream_repo", "template_version", "synced_at", "variables"],
  "additionalProperties": false,
  "properties": {
    "schema_version": {
      "type": "string",
      "description": "Manifest format version for future migrations. Currently only '1' is supported.",
      "pattern": "^[0-9]+$",
      "examples": ["1"]
    },
    "upstream_repo": {
      "type": "string",
      "description": "Source template repository in owner/repo format",
      "pattern": "^[a-zA-Z0-9_.-]+/[a-zA-Z0-9_.-]+$",
      "examples": ["serpro69/claude-starter-kit"]
    },
    "template_version": {
      "type": "string",
      "description": "Git tag (e.g., 'v1.0.0') or commit SHA (7+ characters) from initial setup or last sync",
      "minLength": 1,
      "examples": ["v1.0.0", "abc1234def"]
    },
    "synced_at": {
      "type": "string",
      "description": "ISO 8601 timestamp of creation or last sync",
      "format": "date-time",
      "examples": ["2025-01-27T10:00:00Z"]
    },
    "variables": {
      "type": "object",
      "description": "All substitution values applied during template cleanup",
      "required": ["PROJECT_NAME"],
      "additionalProperties": false,
      "properties": {
        "PROJECT_NAME": {
          "type": "string",
          "description": "Repository name, derived from repo basename during cleanup",
          "minLength": 1,
          "examples": ["my-project"]
        },
        "LANGUAGE": {
          "type": "string",
          "description": "Serena language identifier for semantic code analysis",
          "default": "",
          "examples": ["typescript", "python", "go", "rust", ""]
        },
        "CC_MODEL": {
          "type": "string",
          "description": "Claude Code model alias. 'default' means line removal (no substitution)",
          "default": "default",
          "examples": ["sonnet", "opus", "default"]
        },
        "SERENA_INITIAL_PROMPT": {
          "type": "string",
          "description": "Initial prompt for Serena MCP server",
          "default": "",
          "examples": [""]
        },
        "TM_CUSTOM_SYSTEM_PROMPT": {
          "type": "string",
          "description": "Task Master custom system prompt",
          "default": "",
          "examples": [""]
        },
        "TM_APPEND_SYSTEM_PROMPT": {
          "type": "string",
          "description": "Task Master append system prompt",
          "default": "",
          "examples": [""]
        },
        "TM_PERMISSION_MODE": {
          "type": "string",
          "description": "Task Master permission mode",
          "default": "default",
          "enum": ["default", "full", "minimal"],
          "examples": ["default"]
        }
      }
    }
  }
}
